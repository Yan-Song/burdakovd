Prelude> let chain = 0:1: map (\n -> if even n then 1+chain!!(div n 2) else 1+ch
ain!!(3 * n + 1)) [2..]

def f(x):
   if x==1: return 1
   if x in d: return d[x]
   d[x] = 1 + (f(x/2) if (x%2==0) else f(3 * x + 1))
   return d[x]

   Prelude> let ts = [div (x * (x+1)) 2 | x <- [1..]]
Prelude> take 10 ts
[1,3,6,10,15,21,28,36,45,55]
Prelude> let ndivs x = sum (map (\y -> if mod x y == 0 then (if y * y == x then
1 else 2) else 0) (takeWhile (\y -> y * y <= x) [1..x]))

let divsl x = (map (\y -> if mod x y == 0 then (if y * y == x then (y:) else ((y:).((div x y):))) else id) (takeWhile (\y -> y * y <= x) [1..x]))

let divs x = foldr id [] (divsl x)

let abu x = sum(divs x) > 2 * x

let abs = filter abu [1..28123]
let ss = sort (filter (<=28123) [x+y | x <- abs, y <- abs])

Prelude>

 head $ filter ((>5).ndivs) ts
 
11867216745258291596767088485966669273798582100095758927648586619975930687764095025968215177396570693265703962438125699711941059562545194266075961811883693134762216371218311196004424123489176045121333888565534924242378605373120526670329845322631737678903926970677861161240351447136066048164999599442542656514905088616976279305745609791746515632977790194938965236778055329967326038544356209745856855159058933476416258769264398373862584107011986781891656652294354303384242672408623790331963965457196174228574314820977014549061641307451101774166736940218594168337251710513138183086237827524393177246011800953414994670315197696419455768988692973700193372678236023166645886460311356376355559165284374295661676047742503016358708348137445254264644759334748027290043966390891843744407845769620260120918661264249498568399416752809338209739872047617689422485537053988895817801983866648336679027270843804302586168051835624516823216354234081479331553304809262608491851078404280454207286577699580222132259241827433

def itoa(n):
  if n== 1000: return "one thousand"
  if n >= 100:
    if n % 100 == 0:
      return itoa(n / 100) + " hundred" + ("" if n / 100 == 1 else "")
    else:
      return itoa(n / 100) + " hundred" + ("" if n / 100 == 1 else "") + " and " + itoa(n % 100)
  if n < 20:
    return ["one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen"][n-1]
  else:
    s = ["twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"][n / 10 - 2]
    if n % 10 > 0:
      s = s + "-" + itoa(n % 10)
    return s


2 1 -3            1
1 -1 -2           4
0 3 1            -7


2  1 -3  1
0 -3 -1  7
0  3  1 -7


2  1 -3  1
0 -3 -1  7
0  3  1 -7


2  1 -3  1
0 -3 -1  7
0  0  0  0

1 0 1
1 0 2


1 0
1 0


1 1
1 2

